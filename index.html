<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Invitation - Sangga & Dhilla</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400;1,600&family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- COVER PAGE -->
    <div id="cover-page">
        <div class="cover-content">
            <p class="subtitle font-serif">Undangan Pernikahan</p>
            <div class="couple-img">
                <img src="images/nama.png" alt="Sangga & Dhilla">
            </div>
            <p class="date font-serif">Minggu, 08 Februari 2026</p>
            <p class="font-serif" style="font-size: 1.175rem;">Kepada Yth :</p>
            <p class="font-serif" style="font-size: 1.175rem;">Bpk/Ibu/Saudara/i</p>
            <p class="guest-name font-serif"></p>
            <button class="btn-open" onclick="openInvitation()">‚úâ Buka Undangan</button>
        </div>
    </div>

    <!-- NAVIGATION -->
    <!-- <div class="sticky-nav">
        <div class="nav-icon" onclick="scrollToSection('bride-groom')" title="Mempelai">‚ù§Ô∏è</div>
        <div class="nav-icon" onclick="scrollToSection('time-place')" title="Lokasi">üìç</div>
        <div class="nav-icon" onclick="scrollToSection('love-story')" title="Cerita">üíï</div>
        <div class="nav-icon" onclick="scrollToSection('gift')" title="Hadiah">üéÅ</div>
        <div class="nav-icon" onclick="scrollToSection('wishes')" title="Ucapan">üí¨</div>
        <div class="nav-icon" id="music-btn" onclick="toggleMusic()">üîá</div>
    </div> -->

    <audio id="bg-music" loop>
        <source src="audio/lagu-pernikahan.mp3" type="audio/mp3">
    </audio>

    <!-- MAIN CONTENT -->
    <div id="main-content">
        <header id="wedding-header">
            <div class="header-overlay"></div>
            
            <div class="header-content">
                <p class="subtitle font-serif">Undangan Pernikahan</p>
                
                <div class="couple-img">
                    <img src="images/nama.png" alt="Sangga & Dhilla">
                </div>
                
                <p class="date font-serif">Minggu, 08 Februari 2026</p>
            </div>

            <div class="paper-ripped-header"></div>
        </header>

        <!-- BRIDE & GROOM SECTION -->
        <section id="bride-groom" class="bg-cream">
            <br/>
            <div style="position: absolute; 
                top: -230px; 
                right: -120px;
                transform: rotate(30deg);
                width: 320px; 
                height: 290px; 
                background: url('images/bunga2.png') center/contain no-repeat;
                z-index: 10;">
            </div>
            
            <div class="max-w-md text-center mb-8">
                <p class="font-serif" style="font-size: 0.975rem; line-height: 1.6;">
                    Assalamualaikum Warahmatullahi Wabarakatuh<br/><br/>
                    Dengan memohon rahmat dan ridho Allah Swt, kami bermaksud mengundang 
                    Bapak/Ibu/Saudara/i untuk menghadiri acara pernikahan kami:
                </p>
            </div>

            <h1 class="couple-names font-serif mb-2">
                Sangga
            </h1>

            <p class="text-center mb-2 font-serif" style="font-size: 0.975rem;">
                Susangga
            </p>

            <p class="text-center mb-2 font-serif" style="font-size: 0.975rem;">
                Putra Ketiga dari<br/>Bpk. Surya Alam (Alm) & Ibu Kartini (Alm)
            </p>

            <h1 class="couple-names font-serif mb-4">
                <span style="font-size: 2.5rem;">&</span>
            </h1>

            <h1 class="couple-names font-serif mb-2">
                Dhilla
            </h1>

            <p class="text-center mb-2 font-serif" style="font-size: 0.975rem;">
                Dian Rezki Fadhilla
            </p>

            <p class="text-center mb-2 font-serif" style="font-size: 0.975rem;">
                Putri Pertama dari <br/> Bpk. Yarniwaldi dan Ibu Kuspinah
            </p>

            <!-- <div style="position: absolute; 
                        bottom: 450px; 
                        right: -90px; 
                        width: 200px; 
                        height: 140px; 
                        transform: rotate(270deg);
                        background: url('images/bunga3.png') center/contain no-repeat;
                        z-index: 5;">
            </div> -->

            <div style="position: absolute; 
                        bottom: 250px; 
                        left: -90px; 
                        width: 200px; 
                        height: 140px;
                        transform: rotate(0deg);
                        background: url('images/bunga3.png') center/contain no-repeat;
                        z-index: 5;">
            </div>

            <div style="position: absolute;
                        bottom: -80px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: 300px;
                        height: 320px;
                        background: url('images/bunga1.png') center/contain no-repeat;
                        z-index: 25;">
            </div>

        </section>

        <!-- TIME & PLACE SECTION -->
        
        <section id="time-place" class="bg-green">
            
            <h2 class="font-serif">Waktu & Tempat</h2>
            
            <div class="countdown">
                <div class="countdown-item">
                    <div class="number" id="days">00</div>
                    <div class="label">Hari</div>
                </div>
                <div class="countdown-item">
                    <div class="number" id="hours">00</div>
                    <div class="label">Jam</div>
                </div>
                <div class="countdown-item">
                    <div class="number" id="minutes">00</div>
                    <div class="label">Menit</div>
                </div>
            </div>

            <div class="text-center mb-8">
                <p class="font-serif" style="font-size: 1.125rem; margin-bottom: 0.5rem;">Minggu, 08 Februari 2026</p>
                <p class="font-serif" style="font-size: 0.975rem;">08:00 s.d Selesai</p>
            </div>

            <div class="max-w-md text-center mb-8">
                <p style="font-weight: 600; margin-bottom: 0.5rem;">Sport Center Alam Sutera</p>
                <p class="font-serif" style="font-size: 0.875rem;">
                    Jl. Alam Sutera Boulevard, Pd. Jagung Tim., Kec. Serpong Utara, 
                    Kota Tangerang Selatan, Banten 15326
                </p>
            </div>

            <div class="text-center mb-2" style="margin-top: 4rem; margin-bottom: 1rem;">
                <a href="https://maps.app.goo.gl/JkYptsdb5efHHhm37" target="_blank" class="btn-maps">
                    üìç Google Maps
                </a>
            </div>

            <div class="venue-image">
                <img src="images/venue.png" alt="Venue">
            </div>

            <div class="paper-ripped-bottom"></div>
        </section>

        <!-- DRESS CODE SECTION -->
        <section id="dresscode" class="bg-green">
            <h2 class="font-serif">Dresscode</h2>

            <div class="max-w-md text-center mb-8">
                <p class="font-serif" style="font-size: 0.975rem; line-height: 1.6;">
                    Dengan hormat kami menganjurkan tamu untuk mengenakan baju dengan nuansa warna-warna ini di hari istimewa kami :
                </p>
            </div>

            <div class="dresscode-palette">
                <div class="color-item">
                    <div class="color-circle" style="background-color: #4a5d3f;"></div>
                    <p>Sage Green</p>
                </div>
                
                <div class="color-item">
                    <div class="color-circle" style="background-color: #E8DCC4;"></div>
                    <p>Nude Cream</p>
                </div>
            </div>
            

            <div class="paper-ripped-bottom"></div>

            <div style="position: absolute;
                        bottom: 350px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: 300px;
                        height: 320px;
                        background: url('images/bunga1.png') center/contain no-repeat;
                        z-index: 25;">
            </div>
        </section>

        <!-- LOVE STORY SECTION -->
        <section id="love-story" class="bg-cream">

            <h2 class="font-serif">Love Story</h2>

            <div class="max-w-md">
                <div class="story-item">
                    <div class="story-icon">‚ô°</div>
                    <div class="story-content font-serif">
                        <h3>Awal Bertemu</h3>
                        <p>
                            Ada ajakan Ta'aruf yang diutarakan oleh teman kami, yaitu Mario dan Istirinya. 
                            Kemudian dilakukan nuzur atau pertemuan pertama di Masjid An-Nashr. Ada respon 
                            positif yang kami rasakan, membuat kami memutuskan melanjutkan ke arah ini.
                        </p>
                    </div>
                </div>

                <div class="story-item">
                    <div class="story-icon">‚ô°</div>
                    <div class="story-content font-serif">
                        <h3>Khitbah</h3>
                        <p>
                            Setelah melalui proses saling mengenal, Sangga pun mengutarakan niatnya untuk 
                            meng-khitbah Dhilla di bulan November dan disambut baik oleh kedua keluarga.
                        </p>
                    </div>
                </div>

                <div class="story-item">
                    <div class="story-icon">‚ô°</div>
                    <div class="story-content font-serif">
                        <h3>Pernikahan</h3>
                        <p>
                            Baru saling kenal tapi atas izin Allah berjodoh. InsyaAllah di bulan Februari 
                            ini kami akan melangsungkan ikatan sah yaitu akad nikah.
                        </p>
                    </div>
                </div>
            </div>
            <div class="paper-ripped-bottom"></div>

            <div style="position: absolute;
                        bottom: 450px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: 300px;
                        height: 320px;
                        background: url('images/bunga1.png') center/contain no-repeat;
                        z-index: 25;">
            </div>
        </section>

        <!-- WEDDING GIFT SECTION -->
        <section id="gift" class="bg-green">
            <h2 class="font-serif">Wedding Gift</h2>

            <p class="text-center mb-8 max-w-md font-serif" style="font-size: 0.875rem; line-height: 1.6; margin-left: auto; margin-right: auto;">
                Restu dan doa dari Anda adalah anugerah yang sangat berarti bagi kami. 
                Namun, jika memberi adalah ungkapan kasih sayang Anda, Anda dapat memberikannya 
                secara elektronik.
            </p>

            <div class="max-w-md" style="margin: 0 auto;">
                <div class="gift-card">
                    <div class="gift-text">
                        <h4>Bank Syariah Indonesia - BSI</h4>
                        <p>Dian Rezki Fadhilla<br/>7232533921</p>
                    </div> 
                    <button class="btn-copy" onclick="copyText('7232533921')">üìã Salin</button>
                </div>

                <div class="gift-card">
                    <div class="gift-text">
                        <h4>Bank Syariah Indonesia - BSI</h4>
                        <p>Susangga<br/>7232533921</p>
                    </div>
                    <button class="btn-copy" onclick="copyText('7232533921')">üìã Salin</button>
                </div>

                <div class="gift-card">
                    <div class="gift-text">
                        <h4>Kirim Hadiah</h4>
                        <p>Susangga/Dian Rezki Fadhilla<br/>
                           Jl. Air Dingin, Kel. Air Panas, Kec. Tebet<br/>
                           Ruyuk, Tebet</p>
                    </div>
                    <button class="btn-copy" onclick="copyText('Jl. Air Dingin, Kel. Air Panas, Kec. Tebet, Ruyuk, Tebet')">üìã Salin</button>
                </div>
            </div>

            <div style="position: absolute;
                        bottom: 650px;
                        right: -200px;
                        width: 400px;
                        height: 320px;
                        background: url('images/bunga1.png') center/contain no-repeat;
                        z-index: 25;">
            </div>

            <div style="position: absolute;
                        bottom: -100px;
                        left: 2px;
                        transform: translateX(-50%);
                        width: 400px;
                        height: 320px;
                        background: url('images/bunga1.png') center/contain no-repeat;
                        z-index: 25;">
            </div>

            <div class="paper-ripped-bottom"></div>
        </section>

        <!-- BEST WISHES SECTION -->
        <section id="wishes" class="bg-cream">
            
            <h2 class="font-serif">Best Wishes</h2>

            <form class="wish-form" onsubmit="submitWish(event)">
                <input type="text" id="wish-name" placeholder="Aisyah Nur" required>
                
                <select id="wish-attendance" required>
                    <option value="">Konfirmasi Kehadiran</option>
                    <option value="hadir">Hadir</option>
                    <option value="tidak-hadir">Tidak Hadir</option>
                    <option value="ragu">Masih Ragu</option>
                </select>

                <textarea id="wish-message" placeholder="Tulis Doa dan Harapan..." required></textarea>

                <button type="submit" class="btn-submit">üí¨ Kirim</button>
            </form>

            <div id="wishes-list" class="max-w-md">
                
            </div>

            <div id="pagination-controls" class="text-center mb-8" style="margin-top: 1rem; display: flex; justify-content: center; gap: 10px;">
            
            </div>

            <div style="position: absolute;
                        bottom: -190px;
                        left: 50%;
                        transform: translateX(-50%);
                        width: 300px;
                        height: 320px;
                        background: url('images/bunga1.png') center/contain no-repeat;
                        z-index: 25;">
            </div>

            <div class="paper-ripped-bottom"></div>
        </section>

        <!-- FOOTER -->
        <section class="bg-green" id="footer">
            <p class="text-center mb-8 max-w-md" style="font-size: 0.875rem; line-height: 1.6; margin-left: auto; margin-right: auto; margin-top: 100px;">
                Merupakan suatu kebahagiaan dan kehormatan bagi kami, apabila 
                Bapak/Ibu/Saudara/i, berkenan hadir dan memberikan doa restu kepada kami
            </p>

            <p class="text-center mb-4" style="font-size: 0.875rem;">Kami Yang Berbahagia,</p>

            <div class="footer-couple-img">
                <img src="images/nama.png" alt="Sangga & Dhilla">
            </div>

            <div style="position: absolute;
                        bottom: 0px;
                        right: -150px;
                        transform: rotate(90deg);
                        width: 300px;
                        height: 180px;
                        background: url('images/bunga2.png') center/contain no-repeat;
                        z-index: 25;">
            </div>

            <div style="position: absolute;
                        bottom: 0px;
                        left: -150px;
                        transform: rotate(-90deg) scaleX(-1);
                        width: 300px;
                        height: 180px;
                        background: url('images/bunga2.png') center/contain no-repeat;
                        z-index: 25;">
            </div>

            <p class="text-center" style="font-size: 0.75rem; opacity: 0.7;">¬© Azzahra</p>
        </section>

    </div>

    <script>
        // --- 1. VARIABEL GLOBAL ---
        const music = document.getElementById('bg-music');
        const musicBtn = document.getElementById('music-btn');
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxHXXo41fmV3pWoTfse0LfpmmqsjzkR6A9t8_Ve5u26nSR_LlaGoqYZW5djsbMNQSziPg/exec'
        let isPlaying = false;

        let wishesData = []; // Data kosong awal
        let currentPage = 1;
        const itemsPerPage = 5;

        // --- FUNGSI NAMA TAMU OTOMATIS ---
        function getGuestName() {
            // 1. Ambil parameter dari Link (URL)
            const urlParams = new URLSearchParams(window.location.search);
            const guestName = urlParams.get('to'); 
            
            // 2. Cari elemen HTML yang mau diubah tulisannya
            const guestLabel = document.querySelector('.guest-name'); // Tulisan di Cover
            const inputName = document.getElementById('wish-name');   // Kotak Form Ucapan

            // 3. Jika ada nama di link, ubah tulisannya
            if (guestName) {
                // Ganti nama di Cover
                if(guestLabel) {
                    guestLabel.textContent = guestName;
                }
                
                // Otomatis isi nama di Form Ucapan (biar tamu gak capek ngetik)
                if(inputName) {
                    inputName.value = guestName; 
                    // Opsional: Kunci biar gak bisa diubah
                    // inputName.readOnly = true; 
                }
            }
        }

        // Panggil fungsi ini saat halaman dimuat
        window.onload = function() {
            getGuestName();
            renderWishes(); // (Nanti untuk pagination)
        };

        // --- 2. FUNGSI BUKA UNDANGAN ---
        function openInvitation() {
            const cover = document.getElementById('cover-page');
            const main = document.getElementById('main-content');
            
            // PENTING: Class ini yang memicu navigasi muncul di CSS
            document.body.classList.add('opened');
            
            cover.classList.add('hidden');
            
            setTimeout(() => {
                main.classList.add('show');
            }, 800);

            // Putar musik otomatis saat dibuka
            playMusic();
        }

        // --- 3. FUNGSI SCROLL NAVIGASI ---
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // --- 4. FUNGSI MUSIK ---
        function playMusic() {
            music.play().catch(error => {
                console.log("Autoplay dicegah browser, perlu interaksi user.");
            });
            isPlaying = true;
            if(musicBtn) {
                musicBtn.innerHTML = "üéµ"; 
                musicBtn.classList.add('playing');
            }
        }

        function toggleMusic() {
            if (isPlaying) {
                music.pause();
                isPlaying = false;
                musicBtn.innerHTML = "üîá";
                musicBtn.classList.remove('playing');
            } else {
                music.play();
                isPlaying = true;
                musicBtn.innerHTML = "üéµ";
                musicBtn.classList.add('playing');
            }
        }

        // --- 5. FUNGSI HITUNG MUNDUR (COUNTDOWN) ---
        function updateCountdown() {
            // Pastikan tanggal sesuai target: 8 Feb 2026
            const weddingDate = new Date('2026-02-08T08:00:00').getTime();
            const now = new Date().getTime();
            const difference = weddingDate - now;

            if (difference > 0) {
                const days = Math.floor(difference / (1000 * 60 * 60 * 24));
                const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));

                document.getElementById('days').textContent = String(days).padStart(2, '0');
                document.getElementById('hours').textContent = String(hours).padStart(2, '0');
                document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
            }
        }
        // Jalankan countdown
        setInterval(updateCountdown, 1000);
        updateCountdown();

        // --- 6. FUNGSI SALIN TEKS ---
        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Berhasil disalin: ' + text);
            });
        }

        // --- 7. FUNGSI KIRIM UCAPAN ---
        function submitWish(event) {
            event.preventDefault(); // Mencegah reload halaman
            
            const name = document.getElementById('wish-name').value;
            const message = document.getElementById('wish-message').value;

            // Buat kartu ucapan baru
            const wishCard = document.createElement('div');
            wishCard.className = 'wish-card';
            wishCard.innerHTML = `
                <h4>${name}</h4>
                <p>${message}</p>
            `;

            // Masukkan ke daftar paling atas
            const wishList = document.getElementById('wishes-list');
            wishList.insertBefore(wishCard, wishList.firstChild);

            // Reset form
            event.target.reset();
            alert('Terima kasih atas doa dan ucapannya! üôè');
        }
// --- FUNGSI AMBIL DATA DARI GOOGLE SHEETS (LOAD) ---
        function loadWishes() {
            const listContainer = document.getElementById('wishes-list');
            listContainer.innerHTML = '<p class="text-center" style="font-size:0.8rem">Memuat ucapan...</p>';

            fetch(SCRIPT_URL)
                .then(response => response.json())
                .then(data => {
                    // Simpan data dari sheets ke variabel lokal
                    wishesData = data.data.map(item => ({
                        name: item.nama,
                        message: item.ucapan,
                        attendance: item.kehadiran
                    }));
                    
                    renderWishes(); // Tampilkan
                })
                .catch(error => {
                    console.error('Error:', error);
                    listContainer.innerHTML = '<p class="text-center">Gagal memuat ucapan.</p>';
                });
        }

        // Panggil loadWishes saat halaman dibuka
        window.onload = function() {
            getGuestName();
            loadWishes(); // <--- Panggil fungsi load
        };

// --- FUNGSI RENDER (TAMPILKAN) UCAPAN ---
        function renderWishes() {
            const listContainer = document.getElementById('wishes-list');
            const paginationContainer = document.getElementById('pagination-controls');
            
            listContainer.innerHTML = "";
            paginationContainer.innerHTML = "";

            if (wishesData.length === 0) {
                listContainer.innerHTML = '<p class="text-center" style="font-size:0.8rem">Belum ada ucapan. Jadilah yang pertama!</p>';
                return;
            }

            // Hitung Pagination
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = wishesData.slice(startIndex, endIndex);

            // Render Kartu
            pageData.forEach(wish => {
                const card = document.createElement('div');
                card.className = 'wish-card';
                
                // LOGIKA EMOJI KEHADIRAN
                let emoji = '';
                if (wish.attendance === 'hadir') {
                    emoji = '<span title="Hadir">‚úÖ</span>';
                } else if (wish.attendance === 'tidak-hadir') {
                    emoji = '<span title="Berhalangan">‚ùå</span>';
                } else if (wish.attendance === 'ragu') {
                    emoji = '<span title="Masih Ragu">‚ùì</span>';
                }

                // Tampilkan emoji di sebelah nama
                let attendanceBadge = emoji ? `<span style="font-size:0.7rem; margin-left:2px;">${emoji}</span>` : '';

                // --- BAGIAN INI YANG KEMARIN HILANG ---
                card.innerHTML = `<h4>${wish.name} ${attendanceBadge}</h4><p>${wish.message}</p>`;
                listContainer.appendChild(card);
                // ---------------------------------------
            });

            // Render Tombol Pagination
            const totalPages = Math.ceil(wishesData.length / itemsPerPage);
            if (totalPages <= 1) return;

            if (currentPage > 1) {
                const prevBtn = createPageBtn('<<', () => changePage(currentPage - 1));
                paginationContainer.appendChild(prevBtn);
            }
            for (let i = 1; i <= totalPages; i++) {
                const btn = createPageBtn(i, () => changePage(i));
                if (i === currentPage) btn.classList.add('active'); 
                paginationContainer.appendChild(btn);
            }
            if (currentPage < totalPages) {
                const nextBtn = createPageBtn('>>', () => changePage(currentPage + 1));
                paginationContainer.appendChild(nextBtn);
            }
        }

        // Helper bikin tombol (VERSI BARU - LEBIH BERSIH)
        function createPageBtn(text, onClick) {
            const btn = document.createElement('button');
            btn.innerText = text;
            btn.onclick = onClick;
            // Gunakan class CSS yang kita buat tadi
            btn.className = 'btn-page'; 
            return btn;
        }

        function changePage(page) {
            currentPage = page;
            renderWishes(); // Render ulang saat pindah halaman
        }

        // --- UPDATE FUNGSI KIRIM UCAPAN ---
        function submitWish(event) {
            event.preventDefault();
            
            const btnSubmit = document.querySelector('.btn-submit');
            const originalText = btnSubmit.innerText;
            btnSubmit.innerText = "Mengirim...";
            btnSubmit.disabled = true;

            const name = document.getElementById('wish-name').value;
            const attendance = document.getElementById('wish-attendance').value;
            const message = document.getElementById('wish-message').value;

            // Siapkan data form untuk dikirim
            const formData = new FormData();
            formData.append('nama', name);
            formData.append('kehadiran', attendance);
            formData.append('ucapan', message);

            fetch(SCRIPT_URL, { method: 'POST', body: formData })
                .then(response => {
                    alert('Terima kasih! Ucapan berhasil dikirim.');
                    
                    // Reset Form
                    event.target.reset();
                    btnSubmit.innerText = originalText;
                    btnSubmit.disabled = false;
                    
                    // Refresh data ucapan tanpa reload halaman
                    loadWishes(); 
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    alert('Gagal mengirim ucapan. Coba lagi ya.');
                    btnSubmit.innerText = originalText;
                    btnSubmit.disabled = false;
                });
        }
    </script>

</body>
</html>